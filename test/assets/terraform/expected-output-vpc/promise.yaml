apiVersion: platform.kratix.io/v1alpha1
kind: Promise
metadata:
  creationTimestamp: null
  labels:
    kratix.io/promise-version: v0.0.1
  name: vpc
spec:
  api:
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: vpcs.syntasso.io
    spec:
      group: syntasso.io
      names:
        kind: VPC
        plural: vpcs
        singular: vpc
      scope: Namespaced
      versions:
      - name: v1alpha1
        schema:
          openAPIV3Schema:
            properties:
              spec:
                default: {}
                properties:
                  api_id:
                    description: API identifier.
                    type: string
                  iam:
                    additionalProperties:
                      items:
                        type: string
                      type: array
                    description: IAM bindings for the API in {ROLE => [MEMBERS]} format.
                    type: object
                  labels:
                    additionalProperties:
                      type: string
                    description: Map of labels.
                    type: object
                  project_id:
                    description: Project identifier.
                    type: string
                  region:
                    description: Region.
                    type: string
                  service_account_create:
                    default: false
                    description: Flag indicating whether a service account needs to
                      be created.
                    type: boolean
                  service_account_email:
                    description: Service account for creating API configs.
                    type: string
                  spec:
                    description: String with the contents of the OpenAPI spec.
                    type: string
                type: object
            type: object
        served: true
        storage: true
  destinationSelectors:
  - matchLabels:
      environment: terraform
  workflows:
    config: {}
    promise:
      configure:
      - apiVersion: platform.kratix.io/v1alpha1
        kind: Pipeline
        metadata:
          name: dependencies
        spec:
          containers:
          - image: my-registry.io/my-org/kratix/terraform-dependencies:v0.0.1
            name: add-tf-dependencies
    resource:
      configure:
      - apiVersion: platform.kratix.io/v1alpha1
        kind: Pipeline
        metadata:
          name: instance-configure
        spec:
          containers:
          - env:
            - name: MODULE_SOURCE
              value: git::https://github.com/GoogleCloudPlatform/cloud-foundation-fabric.git//modules/api-gateway?ref=v49.1.0
            image: ghcr.io/syntasso/kratix-cli/terraform-generate:v0.4.0
            name: terraform-generate
status:
  workflows: 0
  workflowsFailed: 0
  workflowsSucceeded: 0
